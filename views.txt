CREATE VIEW EXTRACT_CLIENTS AS SELECT A.ID_CLIENTE, A.ENDERECO,  SUM(C.VALOR) AS 'GASTOS', COUNT(D.ID_VENDA) AS 'QUANTIDADE' FROM CLIENTES A, TABELA_CHAVE B, VENDAS C, ITENS_VENDAS D WHERE A.ID_CLIENTE = B.ID AND B.TABELA = 'CLIENTES' AND B.CARGA = 0 AND C.ID_CLIENTE = A.ID_CLIENTE AND C.ID_VENDA = D.ID_VENDA GROUP BY A.ID_CLIENTE;

CREATE VIEW EXTRACT_STORES AS SELECT A.ID_LOJA, A.ENDERECO, SUM(C.VALOR) AS 'FATURAMENTO_BRUTO', SUM(E.VALOR_VENDA-E.VALOR_COMPRA) AS 'FATURAMENTO_LIQUIDO' FROM LOJAS A, TABELA_CHAVE B, VENDAS C, ITENS_VENDAS D, LIVROS E WHERE A.ID_LOJA = B.ID AND B.TABELA = 'LOJAS' AND B.CARGA = 0 AND C.ID_LOJA = A.ID_LOJA AND C.ID_LOJA = A.ID_LOJA AND C.ID_VENDA = D.ID_VENDA AND D.ID_LIVRO = E.ID_LIVRO  GROUP by A.ID_LOJA;

CREATE VIEW EXTRACT_BOOKS AS SELECT A.ID_LIVRO, A.VALOR_COMPRA, A.VALOR_VENDA FROM LIVROS A, TABELA_CHAVE B WHERE A.ID_LIVRO = B.ID AND B.TABELA = 'LIVROS' AND B.CARGA = 0